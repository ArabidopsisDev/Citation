<UserControl
	x:Class="Citation.View.Page.ViewTimelinePage"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:local="clr-namespace:Citation.View.Page"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	d:DesignHeight="450"
	d:DesignWidth="800"
	Loaded="UserControl_Loaded"
	mc:Ignorable="d">

	<UserControl.Resources>
		<SolidColorBrush x:Key="PrimaryColorBrush" Color="#FF3F51B5" />
		<SolidColorBrush x:Key="LightBackgroundBrush" Color="#FFF5F5F5" />
		<SolidColorBrush x:Key="GrayTextBrush" Color="#FF757575" />
		<SolidColorBrush x:Key="DarkTextBrush" Color="#FF212121" />

		<LinearGradientBrush x:Key="TimelineGradientBrush" StartPoint="0,0.5" EndPoint="1,0.5">
			<GradientStop Offset="0.0" Color="#FF3F51B5" />
			<GradientStop Offset="0.5" Color="#FFE91E63" />
			<GradientStop Offset="1.0" Color="#FF4CAF50" />
		</LinearGradientBrush>

		<Style x:Key="TimelineItemStyle" TargetType="Border">
			<Setter Property="CornerRadius" Value="8" />
			<Setter Property="Padding" Value="8" />
			<Setter Property="Margin" Value="4" />
			<Setter Property="Cursor" Value="Hand" />
			<Setter Property="Background" Value="{Binding Color}" />
			<Setter Property="ToolTip">
				<Setter.Value>
					<ToolTip>
						<StackPanel>
							<TextBlock FontWeight="Bold" Text="{Binding Title}" />
							<TextBlock
								MaxWidth="300"
								Text="{Binding Conclusion}"
								TextWrapping="Wrap" />
							<TextBlock FontStyle="Italic" Text="{Binding Folder}" />
						</StackPanel>
					</ToolTip>
				</Setter.Value>
			</Setter>
		</Style>

		<Style x:Key="MonthLabelStyle" TargetType="TextBlock">
			<Setter Property="FontSize" Value="14" />
			<Setter Property="FontFamily" Value="Calibri" />
			<Setter Property="Foreground" Value="#FF757575" />
			<Setter Property="HorizontalAlignment" Value="Center" />
			<Setter Property="FontWeight" Value="SemiBold" />
		</Style>

		<Style x:Key="YearLabelStyle" TargetType="TextBlock">
			<Setter Property="FontSize" Value="18" />
			<Setter Property="FontWeight" Value="Bold" />
			<Setter Property="Foreground" Value="#FF3F51B5" />
			<Setter Property="FontFamily" Value="Calibri" />
			<Setter Property="HorizontalAlignment" Value="Center" />
			<Setter Property="Margin" Value="0,0,0,4" />
		</Style>

		<Style x:Key="ArticleTitleStyle" TargetType="TextBlock">
			<Setter Property="FontSize" Value="12" />
			<Setter Property="FontFamily" Value="Calibri" />
			<Setter Property="TextWrapping" Value="Wrap" />
			<Setter Property="TextTrimming" Value="CharacterEllipsis" />
			<Setter Property="MaxWidth" Value="120" />
			<Setter Property="MaxHeight" Value="36" />
			<Setter Property="Foreground" Value="#FF212121" />
		</Style>

		<Style x:Key="TimelineNodeStyle" TargetType="Ellipse">
			<Setter Property="Width" Value="16" />
			<Setter Property="Height" Value="16" />
			<Setter Property="Stroke" Value="White" />
			<Setter Property="StrokeThickness" Value="2" />
		</Style>
	</UserControl.Resources>

	<Grid Background="#FFF5F5F5">
		<ScrollViewer
			x:Name="TimelineScrollViewer"
			Padding="20,0"
			HorizontalScrollBarVisibility="Auto"
			PreviewMouseWheel="TimelineScrollViewer_PreviewMouseWheel"
			VerticalScrollBarVisibility="Disabled">

			<!--  使用Grid作为ScrollViewer的唯一子元素  -->
			<Grid>
				<!--  时间轴主线  -->
				<Canvas Height="80" VerticalAlignment="Center">
					<Rectangle
						Canvas.Left="0"
						Canvas.Top="37"
						Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType=ScrollViewer}}"
						Height="6"
						Fill="{StaticResource TimelineGradientBrush}"
						RadiusX="3"
						RadiusY="3" />
				</Canvas>

				<ItemsControl Margin="0,20,0,0" ItemsSource="{Binding TimelineGroups}">
					<ItemsControl.ItemsPanel>
						<ItemsPanelTemplate>
							<StackPanel Orientation="Horizontal" />
						</ItemsPanelTemplate>
					</ItemsControl.ItemsPanel>
					<ItemsControl.ItemTemplate>
						<DataTemplate>
							<Grid MinWidth="180" Margin="20,0">
								<StackPanel
									Margin="0,40"
									HorizontalAlignment="Center"
									VerticalAlignment="Top">
									<TextBlock Style="{StaticResource YearLabelStyle}" Text="{Binding Year}" />
									<TextBlock Style="{StaticResource MonthLabelStyle}" Text="{Binding Month, StringFormat='{}{0:00}'}" />
								</StackPanel>

								<Ellipse
									HorizontalAlignment="Center"
									VerticalAlignment="Center"
									Fill="{Binding Items[0].Color}"
									Style="{StaticResource TimelineNodeStyle}" />

								<ScrollViewer
									Height="120"
									Margin="0,50,0,0"
									HorizontalScrollBarVisibility="Auto"
									VerticalScrollBarVisibility="Disabled">
									<ItemsControl ItemsSource="{Binding Items}">
										<ItemsControl.ItemsPanel>
											<ItemsPanelTemplate>
												<StackPanel Orientation="Horizontal" />
											</ItemsPanelTemplate>
										</ItemsControl.ItemsPanel>
										<ItemsControl.ItemTemplate>
											<DataTemplate>
												<Border
													Width="140"
													Height="80"
													Margin="4"
													MouseLeftButtonUp="TimelineItem_MouseLeftButtonUp"
													Style="{StaticResource TimelineItemStyle}">
													<TextBlock Style="{StaticResource ArticleTitleStyle}" Text="{Binding Conclusion}" />
												</Border>
											</DataTemplate>
										</ItemsControl.ItemTemplate>
									</ItemsControl>
								</ScrollViewer>
							</Grid>
						</DataTemplate>
					</ItemsControl.ItemTemplate>
				</ItemsControl>
			</Grid>
		</ScrollViewer>
	</Grid>
</UserControl>